<!DOCTYPE html>
<html>
<head>
    <title>JavaScript Error Debug</title>
</head>
<body>
    <div id="debug-output"></div>
    <script>
        // Override console.error to capture JavaScript errors
        const originalError = console.error;
        console.error = function(...args) {
            const errorDiv = document.getElementById('debug-output');
            errorDiv.innerHTML += '<div style="color: red; font-family: monospace; margin: 5px 0;">' + 
                                  args.join(' ') + '</div>';
            originalError.apply(console, args);
        };

        // Capture unhandled errors
        window.addEventListener('error', function(e) {
            const errorDiv = document.getElementById('debug-output');
            errorDiv.innerHTML += '<div style="color: red; font-family: monospace; margin: 5px 0; border: 1px solid red; padding: 5px;">' + 
                                  'ERROR: ' + e.message + ' at line ' + e.lineno + ' in ' + e.filename + '</div>';
        });

        // Test the simulation call that's causing issues
        fetch('/api/thesis/58/simulate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                time_horizon: 1,
                scenario: 'base',
                volatility: 'moderate',
                include_events: false
            })
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById('debug-output').innerHTML += 
                '<div style="color: green; margin: 10px 0;">Simulation data received successfully</div>' +
                '<pre style="background: #f0f0f0; padding: 10px; margin: 10px 0;">' + 
                JSON.stringify(data, null, 2) + '</pre>';
        })
        .catch(error => {
            document.getElementById('debug-output').innerHTML += 
                '<div style="color: red; margin: 10px 0;">Fetch error: ' + error.message + '</div>';
        });
    </script>
</body>
</html>